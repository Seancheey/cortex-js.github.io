<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">


<title>
    CortexJS
</title>
<meta name="description" content="" />


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="CortexJS Feed">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="strict-origin" />

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>


  
    
      
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.0/codemirror.min.js" crossorigin='anonymous'></script>
  
    
      
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.0/mode/javascript/javascript.min.js" crossorigin='anonymous'></script>
  
    
      
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.0/mode/xml/xml.min.js" crossorigin='anonymous'></script>
  



  
    
      
    
    <script type="module" src="/assets/js/code-playground.js" crossorigin='anonymous'></script>
  



<link rel="stylesheet" href="/assets/css/main.css">

  
    
      
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.0/codemirror.min.css">
  





    <link
    crossorigin
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:100,100i,400,400i,700,700i,900,900i&display=block"
    rel="stylesheet"
/>

<link
    crossorigin
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=IBM+Plex+Sans:ital,wght@0,400;0,700;1,400;1,700&display=block"
/>


<script src="https://kit.fontawesome.com/523e3eb8bb.js" crossorigin="anonymous"></script>

<!-- <script>
  // ((window.gitter = {}).chat = {}).options = {
  //   room: 'cortex-js/community',
  //   activationElement: '.my-special-button',
  //   targetElement: '.my-special-target-element'
  // };
</script> -->
<!-- <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script> -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    
  


<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="" alt=""></a>
        
        <a class="site-title" href="/">
          Cortex<em>JS</em>
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/math-json/" >MathJSON</a>
            </li><li class="masthead__menu-item">
              <a href="/cortex/" >Cortex</a>
            </li><li class="masthead__menu-item">
              <a href="/mathlive/" >MathLive</a>
            </li><li class="masthead__menu-item">
              <a href="/docs/" >Docs</a>
            </li><li class="masthead__menu-item">
              <a href="/funding/" >Funding</a>
            </li><li class="masthead__menu-item">
              <a href="https://gitter.im/cortex-js" title="Chat on Gitter"><svg class='icon1em'><use role='none' xlink:href='/assets/icons.svg#gitter'></use></svg></a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/cortex-js" title="Get source code on GitHub"><svg class='icon1em'><use role='none' xlink:href='/assets/icons.svg#github'></use></svg></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




<div id="main" role="main">
  
  <div class="sidebar sticky">
    
      
      
      

      
<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="ellipsis-h" class="svg-inline--fa fa-ellipsis-h" style="width:32px; height: 32px;" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M192 256c0 17.7-14.3 32-32 32s-32-14.3-32-32 14.3-32 32-32 32 14.3 32 32zm88-32c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm-240 0c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32z"></path></svg></label>
  <ul class="nav__items">
    
      <li>
        
          
          
            
          

          <a href="/cortex/"><span class="nav__sub-title">Cortex</span></a>
        

        
      </li>
    
      <li>
        
          <span class="nav__sub-title">MathLive</span>
        

        
        <ul>
          
            
            
              
            

            
            
              
            

            <li><a href="/guides/mathfield-getting-started/" class="">Getting Started</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/docs/mathlive/" class="">SDK Reference</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">MathLive Guides</span>
        

        
        <ul>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/introduction" class="">Introduction</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/interacting" class="">Interacting</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/customizing" class="">Customize</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/commands" class="">Commands</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/macros" class="">Macros</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/shortcuts" class="">Shortcuts</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/speech" class="">Speech</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/static" class="">Static</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/virtual-keyboards" class="">Virtual Keyboards</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/mathlive/guides/lifecycle" class="">Lifecycle</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          
            
          

          <a href="/math-json/"><span class="nav__sub-title">MathJSON</span></a>
        

        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Contributing</span>
        

        
        <ul>
          
            
            
              
            

            
            
              
            

            <li><a href="/docs/reporting-issues/" class="">Reporting Issues</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/funding/" class="">Funding</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/docs/code-of-conduct/" class="">Code of Conduct</a></li>
          
            
            
              
            

            
            
              
            

            <li><a href="/docs/license/" class="">License</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">

    <div class="page__inner-wrap">
      
        <header>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <script>
    moduleMap = {
        mathlive: "//unpkg.com/mathlive/dist/mathlive.mjs",
        "html-to-image": "///assets/js/html-to-image.js",
    };
</script>
<h1>Speech</h1>
<p>This example shows how to configure the MathLive text-to-speech features.</p>
<p>There are two aspects that can be configured independently:</p>
<ol>
<li>
<p>Speech Rules: the set of rules use to produce readable text from a math expression. MathLive has a built-in set of speech rules, but it can also be configured to use Volker Sorgeâ€™s Speech Rule Engine.</p>
</li>
<li>
<p>Text-to-Speech engine: the software used to transform the readable text produced by the speech rules into sound. By default, the TTS engine provide by the operating system will be used, but MathLive can be configured to use the Amazon Cloud TTS engine as well.</p>
</li>
</ol>
<h2>Speech Rules</h2>
<p>The format of the output can be configured using the <code>textToSpeechMarkup</code> configuration option. Set it to:</p>
<ul>
<li><code>'ssml'</code> to request an output using the SSML markup language. Both SRE and the MathLive rules can produce this format.</li>
<li><code>'mac'</code> to request an output using Mac OS speech markup, e.g. â€˜[[slc 150]]â€™. This format can only be used on Mac OS (and may not work will all browsers). On platforms other than Mac OS, this option does nothing.</li>
<li><code>''</code> (empty string) to request no markup.</li>
</ul>
<p>The Amazon TTS engine supports SSML, and it is recommended to use this option for the highest quality.</p>
<p>To use Volker Sorgeâ€™s SRE:</p>
<ol>
<li>Include the browser version of the SRE JavaScript file in your project. You can download it on <a href="https://github.com/zorkow/speech-rule-engine">GitHub</a></li>
<li>Set the <code>textToSpeechRules</code> configuration key to <code>'sre'</code>.</li>
</ol>
<p>You can configure SRE by setting the <code>textToSpeechRulesOptions</code> configuration key. For example:</p>
<pre><code class="language-javascript">textToSpeechRulesOptions: {
    <span class="hljs-attr">domain</span>: <span class="hljs-string">&#x27;mathspeak&#x27;</span>, <span class="hljs-comment">// &#x27;mathspeak&#x27; or &#x27;chromevox&#x27;</span>
    <span class="hljs-attr">ruleset</span>: <span class="hljs-string">&#x27;mathspeak-brief&#x27;</span>,   <span class="hljs-comment">// &#x27;mathspeak-default&#x27;, &#x27;mathspeak-brief&#x27;, &#x27;mathspeak-sbrief&#x27;, &#x27;chromevox-short&#x27;, &#x27;chromevox-default&#x27; or &#x27;chromevox-alternative&#x27;</span>
},
</code></pre>
<h2>Text-to-Speech Engine</h2>
<h3>Using the Local TTS Engine</h3>
<p>To use the local (built-in, OS specific) TTS engine, set the <code>speechEngine</code> configuration key to <code>'local'</code>.</p>
<p>There is great variation between platforms (and browsers) on the quality of the TTS engine. However, it can be used even when offline, while the Amazon TTS engine offers higher quality and better consistency, but it does require a network connection.</p>
<h3>Using Amazon Polly TTS Engine</h3>
<ol>
<li>Include the AWS SDK for JavaScript in your app. See <a href="https://aws.amazon.com/sdk-for-browser/">here for details</a>.
This may be as simple as adding this:</li>
</ol>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://sdk.amazonaws.com/js/aws-sdk-2.657.0.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        AWS.config.region = <span class="hljs-string">&#x27;eu-west-1&#x27;</span>;
        AWS.config.accessKeyId = <span class="hljs-string">&#x27;YOUR-KEY&#x27;</span>;
        AWS.config.secretAccessKey = <span class="hljs-string">&#x27;YOUR-SECRET&#x27;</span>;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</code></pre>
<p>See <a href="https://www.npmjs.com/package/aws-sdk">npm</a> for the latest version.</p>
<ol start="2">
<li>
<p>To get the necessary keys, follow <a href="https://docs.aws.amazon.com/polly/latest/dg/setting-up.html">these instructions</a></p>
<p>2.1 Create a custom policy in your <a href="https://console.aws.amazon.com/iam/home">AWS console</a> with action: Read SynthesizeSpeech and a request condition of a referer with a StringEquals to your domain, e.g. â€˜https://example.com/*â€™</p>
<p>2.2 Create a group, and associated it with the policy above</p>
<p>2.3. Create a new user, for example the name of your app. Give it â€˜programmatic accessâ€™ and associate it with the group above</p>
<p>2.4 At the end of the creation, you will be provided by the access key and the secret access key.</p>
</li>
</ol>
<p>Carefully consider what you do with the access and secret access keys. Although with the setup above you have somewhat restricted them to a domain, they could be abused if accessed by an unauthorized user. To prevent this, you could require users to authenticate and use AWS Cognito.</p>
<h3>Using the Google Cloud TTS Engine</h3>
<p>NOTE: THE GOOGLE CLOUD TTS ENGINE IS NOT YET SUPPORTED</p>
<p>To use the Google Cloud TTS engine you will need to create a Google Cloud Platform project, enable billing for the project, enable it to use the TTS API, and obtain a <strong>service account key</strong>. See <a href="https://cloud.google.com/text-to-speech/docs/quickstart-protocol">detailed instructions from Google.</a>.</p>
<p>After creating the <strong>service account key</strong> and downloading the JSON file containing it to your local machine, install the Google Cloud SDK, then run</p>
<pre><code class="language-sh">$ gcloud auth activate-service-account --key-file=/PATH/TO/KEYFILE.json
</code></pre>
<p>Set the <code>GOOGLE_APPLICATION_CREDENTIALS</code> variable to point to your keyfile</p>
<pre><code class="language-sh">$ GOOGLE_APPLICATION_CREDENTIALS=/PATH/TO/KEYFILE.json
</code></pre>
<p>Login into the auth console</p>
<pre><code class="language-sh">$ gcloud auth application-default login
</code></pre>
<p>Run</p>
<pre><code class="language-sh">$ gcloud auth application-default print-access-token
</code></pre>
<p>This should spit out an access key.</p>
<p>Set the <code>speechEngine</code> configuration key to <code>'google'</code></p>
<p>Set the <code>speechEngineToken</code> configuration key to the access key obtained earlier.</p>
<code-playground layout="stack" class="m-lg w-full-lg">
    <div slot="javascript">import MathLive from 'mathlive';
MathLive.makeMathField(document.getElementById('mathfield'));
</div>
    <div slot="html">&lt;div id="mathfield" style="
        font-size: 32px; 
        padding: 8px; 
        border-radius: 8px;
        border: 1px solid rgba(0, 0, 0, .3); 
        box-shadow: 0 0 8px rgba(0, 0, 0, .2)"
&gt;x=\frac{-b\pm \sqrt{b^2-4ac}}{2a}
&lt;/div&gt;
</div>
</code-playground>
<h2>Next</h2>
<dl>
<dt><a href="/mathlive/guides//static">Static Math<span><i class="fas fa-chevron-right navigation"></i><span></span></a></dt>
<dd>Display static math formulas</dd>
</dl>

        
      </section>

      <footer class="page__meta">
        
        


        <meta itemprop="datePublished" content="April 03, 2021">
        
        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="Sat Apr 03 2021 10:12:09 GMT+0200 (Central European Summer Time)">April 03, 2021</time></p>
        
      </footer>


      
    </div>

  </article>
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
         
         
         
         
         
         
         
        
        <li>
            <a href="https://github.com/cortex-js" rel="nofollow noopener noreferrer"
                ><svg class='icon1em'><use role='none' xlink:href='/assets/icons.svg#github'></use></svg>GitHub</a
            >
        </li>
         
         
         
         
         
         
         
         
        
        <li>
            <a href="https://gitter.im/cortex-js" rel="nofollow noopener noreferrer"
                ><svg class='icon1em'><use role='none' xlink:href='/assets/icons.svg#gitter'></use></svg>Gitter</a
            >
        </li>
         
         
        

    </ul>
</div>
<div class="page__footer-pages">
             
    <ul>
         
        
        <li>
            <a href="/about" rel="nofollow noopener noreferrer">About Us</a
            >
        </li>
         
         
    </ul>
        

</div>
      </footer>
    </div>

    
  <!-- <script src="/assets/js/main.min.js"></script> -->









  </body>
</html>